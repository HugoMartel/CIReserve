<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: request.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: request.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @file Request module used to communicate with the client
 * @author CIReserve
 * @version 1.0.0
 */

 const fs = require("fs");
 const { validationResult } = require('express-validator');

/**
 * Process the POST and GET requests from the express app in index.js
 * @type {Object}
 * @return {Object} functions to use with the Request module
 * @name Request
 * @namespace Request
 */
const Request = (function() {

    /**
    * @function AppRequest.register
    * @param {Object} request
    * user's request
    * @param {Object} response
    * server's response
    * @returns {} /
    * @description POST request handler for an user registration to the site
    */
     let registerCall = (req, res) => {
        const errors = validationResult(req);

        if (!errors.isEmpty()) {
          console.log(errors);
          return res.status(400).json({ errors: errors.array() });
        } else {
          //Get XMLHttpRequests values
          let passwordChecked = req.body.password;
          let usernameChecked = escape(req.body.username.trim());

          // Check if the credentials are correct
          if (
            usernameChecked.length > 3 &amp;&amp;
            passwordChecked.length > 8 &amp;&amp;
            /[0-9]/.test(passwordChecked) &amp;&amp;
            /[A-Z]/.test(passwordChecked) &amp;&amp;
            /[a-z]/.test(passwordChecked)
          ) {
            //TODO
            //if (! username already exist in database) {add user in database}
          } else {
            console.log("Wrong logins credentials...");
            res.json({ error: "Wrong logins credentials..." });
          }
        }
      };

//===============================================================================
    /**
    * @function AppRequest.login
    * @param {Object} request
    * user's request
    * @param {Object} response
    * server's response
    * @returns {} /
    * @description POST request handler for an user connection to his account
    */
    let loginCall = (req, res) => {
        const errors = validationResult(req);

        if (
            !errors.isEmpty() ||
            !(req.body.username === 'string') ||
            !(req.body.password === 'string')
        ) {
            //console.log(errors, req.body.username, req.body.password);//! DEBUG
            return res.status(400).json({ errors: errors.array() });
        } else {
            let usernameChecked = escape(req.body.username.trim());
            let passwordChecked = req.body.password;

            //TODO
            //check in database
        }
    };


//===============================================================================
//===============================================================================
    return {
        register: (req, res) => registerCall(req, res),
    };
})();

module.exports = { Request };
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Namespaces</h3><ul><li><a href="Connection.html">Connection</a></li><li><a href="Request.html">Request</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.7</a> on Fri Jan 14 2022 06:02:55 GMT+0100 (Central European Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
